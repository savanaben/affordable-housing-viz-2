(function(){"use strict";var e={7812:function(e,t,o){var n=o(9242),i=o(3396),a=o(7139);const s={class:"p-5 bg-image"},l=(0,i._)("div",{class:"p-5"},[(0,i._)("h1",null,"Affordable housing and the Mount Laurel Act"),(0,i._)("p",{class:"fs-4"},"Some title test text here Some title test text here Some title test text here Some title test text hereSome title test text hereSome title test text here https://www.princeton.edu/news/2012/01/19/plans-merwick-stanworth-housing-unveiled")],-1),r=(0,i._)("div",{class:"p-5"},[(0,i._)("h1",null,"The need is high"),(0,i._)("p",{class:"fs-4"},"Some title test text here Some title test text here Some title test text here Some title test text hereSome title test text hereSome title test text here https://www.princeton.edu/news/2012/01/19/plans-merwick-stanworth-housing-unveiled")],-1),c=(0,i._)("div",{class:"container-fluid"},[(0,i._)("div",{class:"row"},[(0,i._)("div",{class:"col-md-2"}),(0,i._)("div",{class:"col-md-8"},[(0,i._)("div",{class:"p-5"},[(0,i._)("h1",null,"Test Scroll in a Page")])]),(0,i._)("div",{class:"col-md-2"})])],-1),d=(0,i._)("div",{class:"p-5"},[(0,i._)("h1",null,"Some title test"),(0,i._)("p",{class:"fs-4"},"Some title test text here Some title test text here Some title test text here Some title test text hereSome title test text hereSome title test text here")],-1);function u(e,t,o,n,u,p){const m=(0,i.up)("MapboxMap"),h=(0,i.up)("MapOverlay"),v=(0,i.up)("FullPageSection"),f=(0,i.up)("FullPageWrapper"),g=(0,i.up)("HousingDataModal");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",{class:(0,a.C_)(["map-container",u.isMapClickable?"clickable":"not-clickable"])},[(0,i.Wm)(m,{onOpenHousingDataModal:p.handleHousingDataModal},null,8,["onOpenHousingDataModal"])],2),(0,i.Wm)(f,{onOnLeave:p.onSectionLeave},{default:(0,i.w5)((()=>[(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i._)("div",s,[(0,i.Wm)(h,{title:"New Jersey Affordable Housing",content:"The successes of Mount Laurel, yet the unmet need for affordable housing in New Jersey."})])])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[l])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[r])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Wm)(h,{title:"The need is high",content:"Custom content text here."})])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Wm)(h,{title:"The need is higher!",content:"Custom content text here."})])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[c])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[d])),_:1})])),_:1},8,["onOnLeave"]),(0,i.Wm)(g,{ref:"housingDataModal",fields:u.modalFields},null,8,["fields"])],64)}function p(e,t,o,n,a,s){return(0,i.wg)(),(0,i.iD)("div",{id:"fullpage",ref:"fullPageWrapper",onDisableScrolling:t[0]||(t[0]=(...e)=>s.disableScrolling&&s.disableScrolling(...e)),onEnableScrolling:t[1]||(t[1]=(...e)=>s.enableScrolling&&s.enableScrolling(...e))},[(0,i.WI)(e.$slots,"default",{},void 0,!0)],544)}var m=o(2120),h=o.n(m),v={name:"FullPageWrapper",data(){return{fullpageInstance:null}},mounted(){this.$nextTick((()=>{this.fullpageInstance=new(h())(this.$refs.fullPageWrapper,{onLeave:(e,t,o)=>{this.$emit("onLeave",e,t,o)}})}))},beforeUnmount(){this.fullpageInstance&&this.fullpageInstance.destroy("all")},methods:{disableScrolling(){this.fullpageInstance&&(this.fullpageInstance.setAllowScrolling(!1),this.fullpageInstance.setKeyboardScrolling(!1))},enableScrolling(){this.fullpageInstance&&(this.fullpageInstance.setAllowScrolling(!0),this.fullpageInstance.setKeyboardScrolling(!0))}}},f=o(89);const g=(0,f.Z)(v,[["render",p],["__scopeId","data-v-107ec602"]]);var b=g;const y={class:"section"};function _(e,t,o,n,a,s){return(0,i.wg)(),(0,i.iD)("div",y,[(0,i.WI)(e.$slots,"default",{},void 0,!0)])}var w={name:"FullPageSection"};const M=(0,f.Z)(w,[["render",_],["__scopeId","data-v-363504a8"]]);var C=M;const L=(0,i._)("div",{id:"map"},null,-1);function D(e,t,o,n,a,s){return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("button",{class:"btn btn-primary mt-2",onClick:t[0]||(t[0]=(...e)=>s.showCountiesLayer&&s.showCountiesLayer(...e)),style:{position:"absolute",top:"20px",right:"20px","z-index":"9999"}}," Counties "),(0,i._)("button",{class:"btn btn-primary mt-2",onClick:t[1]||(t[1]=(...e)=>s.showMunicipalitiesLayer&&s.showMunicipalitiesLayer(...e)),style:{position:"absolute",top:"60px",right:"20px","z-index":"9999"}}," Municipalities "),(0,i._)("button",{class:"btn btn-primary mt-2",onClick:t[2]||(t[2]=(...e)=>s.showJacobsonLayer&&s.showJacobsonLayer(...e)),style:{position:"absolute",top:"100px",right:"20px","z-index":"9999"}}," Jacobson "),L])}var P=o(7709),S=o.n(P),k=o(3168),x={name:"MapboxMap",components:{},data(){return{map:null,currentPopup:null,layers:[{id:"states",name:"County Data",geoJsonUrl:"geoJSON/County_Boundaries_of_NJ2C_Hosted2C_3857.geojson",csvUrl:"/data-csvs/County_data.csv",fillColor:"rgba(200, 100, 240, 0.22)",lineColor:"#3a3a3a",lineWidth:1,visible:!0},{id:"municipalities",name:"Municipality Data",geoJsonUrl:"geoJSON/Municipal_Boundaries_of_NJ2C_Hosted2C_3857.geojson",csvUrl:"/data-csvs/Total_Units_per_Comu.csv",fillColor:"rgba(200, 100, 240, 0.22)",lineColor:"#3a3a3a",lineWidth:1,visible:!1},{id:"jacobson",name:"Jacobson Data",geoJsonUrl:"geoJSON/Municipal_Boundaries_of_NJ2C_Hosted2C_3857.geojson",csvUrl:"/data-csvs/Total_Units_per_Comu.csv",fillColor:"rgba(200, 100, 240, 0.22)",lineColor:"#3a3a3a",lineWidth:1,visible:!1}],csvDataLookup:{}}},mounted(){this.initMap().then((()=>{this.map.getCanvasContainer().addEventListener("mouseenter",(()=>{this.$emit("disable-scrolling")})),this.map.getCanvasContainer().addEventListener("mouseleave",(()=>{this.$emit("enable-scrolling")}))}))},methods:{async initMap(){S().accessToken="pk.eyJ1Ijoic2F2YW5hYmVuIiwiYSI6ImNsZTNobWs4YjA0eGkzcG1wZzhycjZrb3cifQ.4_Du3FBo2v9tdy2DZRhb6A";const e=new(S().Map)({container:"map",style:"mapbox://styles/mapbox/light-v11",center:[-75.7057,40.1583],zoom:7.3});this.map=e;const t="/affordable-housing-viz-2/";for(const o of this.layers)if(o.csvUrl){const e=await this.fetchCsvData(`${t}${o.csvUrl}`,o.id);this.csvDataLookup[o.id]=e}return new Promise((o=>{e.on("load",(async()=>{for(const o of this.layers)this.loadLayer(e,{...o,geoJsonUrl:`${t}${o.geoJsonUrl}`});o()}))}))},async loadLayer(e,t){e.addSource(t.id,{type:"geojson",data:t.geoJsonUrl}),e.addLayer({id:`${t.id}-layer`,type:"fill",source:t.id,paint:{"fill-color":t.fillColor},layout:{visibility:t.visible?"visible":"none"}}),e.addLayer({id:`${t.id}-outline`,type:"line",source:t.id,paint:{"line-color":t.lineColor,"line-width":t.lineWidth},layout:{visibility:t.visible?"visible":"none"}}),this.addMapInteractions(e,t)},async fetchCsvData(e,t){const o=await k.gyn(e),n={};return o.forEach((e=>{if("municipalities"===t){const t=e.comuMerged;n[t]={column2:e.column2,column3:e.column3,units:e.units}}else if("jacobson"===t){const t=e.comuMerged;n[t]={total:e["Total"],priorRound:e["Prior Round Obligations (1987-1999)"],presentNeed:e["Present Need (2015)"],gapPresentNeed:e["Gap Present Need (2015)"],prospectiveNeed:e["Prospective Need (2015-2025)"],prospectiveGapPresent:e["Prospective + Gap Present"]}}else{const t=e.COUNTY;n[t]={column2:e.column2,column3:e.column3,units:e.units}}})),n},createDetailedHousingDataButton(e,t){const o=document.createElement("button");return o.type="button",o.classList.add("btn","mt-2","btn-primary","btn-sm"),o.textContent="Detailed Housing Data",o.addEventListener("click",(()=>this.openHousingDataModal(e,t))),o},async openHousingDataModal(e,t){this.$emit("open-housing-data-modal",{municipalityName:e,comuMerged:t,items:[]})},getPopupContent(e,t){if("states"===e){const o=t.COUNTY_LABEL,n=this.csvDataLookup[e][t.COUNTY],i=document.createElement("div");if(i.innerHTML=`<strong>${o}</strong>`,n){if(n.column2){const e=document.createElement("div");e.innerHTML=`Column 2: ${n.column2}`,i.appendChild(e)}if(n.column3){const e=document.createElement("div");e.innerHTML=`Column 3: ${n.column3}`,i.appendChild(e)}}return i}if("municipalities"===e){const o=t.NAME,n=this.csvDataLookup[e][t.MUN_CODE],i=document.createElement("div");if(i.innerHTML=`<h5><strong>${o}</strong></h5>`,n&&n.units){const e=document.createElement("div");e.innerHTML=`Units: ${n.units}`,i.appendChild(e)}const a=this.createDetailedHousingDataButton(o,t.MUN_CODE);return i.appendChild(a),i}if("jacobson"===e){const o=t.NAME,n=this.csvDataLookup[e][t.MUN_CODE];console.log("rowData",n);const i=document.createElement("div");if(i.innerHTML=`<h5><strong>${o}</strong></h5>`,n){if(n.total){const e=document.createElement("div");e.innerHTML=`<strong>Total: ${n.total}<strong>`,i.appendChild(e)}if(n.priorRound){const e=document.createElement("div");e.innerHTML=`Prior Round Obligations (1987-1999): ${n.priorRound}`,i.appendChild(e)}if(n.presentNeed){const e=document.createElement("div");e.innerHTML=`Present Need (2015): ${n.presentNeed}`,i.appendChild(e)}if(n.gapPresentNeed){const e=document.createElement("div");e.innerHTML=`Gap Present Need (2015): ${n.gapPresentNeed}`,i.appendChild(e)}if(n.prospectiveNeed){const e=document.createElement("div");e.innerHTML=`Prospective Need (2015-2025): ${n.prospectiveNeed}`,i.appendChild(e)}if(n.prospectiveGapPresent){const e=document.createElement("div");e.innerHTML=`Prospective + Gap Present: ${n.prospectiveGapPresent}`,i.appendChild(e)}}else console.log("No rowData found for",t.MUN_CODE);return i}},getColorSet(e){const t={default:[{value:1,color:"#f7fcfd"},{value:5,color:"#e0ecf4"},{value:28,color:"#bfd3e6"},{value:149,color:"#9ebcda"},{value:791,color:"#8c96c6"},{value:4196,color:"#8856a7"},{value:1/0,color:"#810f7c"}],jacobson:[{value:1,color:"#ffffcc"},{value:4,color:"#d9f0a3"},{value:17,color:"#addd8e"},{value:73,color:"#78c679"},{value:303,color:"#41ab5d"},{value:1266,color:"#238443"},{value:1/0,color:"#005a32"}]};return t[e]||t.default},getFillColor(e,t){const o=this.getColorSet(t),n=parseInt(e,10);for(const i of o)if(n<=i.value)return i.color},addMapInteractions(e,t){const o=t.id,n=this.layers.find((e=>e.id===o));if("municipalities"===o){const t=["match",["get","MUN_CODE"],...Object.entries(this.csvDataLookup[o]).flatMap((([e,t])=>[e,this.getFillColor(t.units,"default")])),"rgba(0, 0, 0, 0)"];e.setPaintProperty(`${o}-layer`,"fill-color",t)}if("jacobson"===o){const t=["match",["get","MUN_CODE"],...Object.entries(this.csvDataLookup[o]).flatMap((([e,t])=>[e,this.getFillColor(t.total,"jacobson")])),"rgba(0, 0, 0, 0)"];e.setPaintProperty(`${o}-layer`,"fill-color",t)}e.on("click",`${o}-layer`,(t=>{if(!n.visible)return;const i=t.features[0].properties,a=this.getPopupContent(o,i);this.currentPopup&&this.currentPopup.remove(),this.currentPopup=(new(S().Popup)).setLngLat(t.lngLat).setDOMContent(a).addTo(e);const s=a.querySelector("button");s&&s.addEventListener("click",(()=>{this.$emit("open-housing-data-modal",{municipalityName:i.NAME,munCode:i.MUN_CODE})}))})),e.on("mouseenter",`${o}-layer`,(()=>{e.getCanvas().style.cursor="pointer"})),e.on("mouseleave",`${o}-layer`,(()=>{e.getCanvas().style.cursor=""}))},showMunicipalitiesLayer(){const e="municipalities";this.layers.forEach((t=>{t.visible=t.id===e;const o=t.visible?"visible":"none";this.map.setLayoutProperty(`${t.id}-layer`,"visibility",o),this.map.setLayoutProperty(`${t.id}-outline`,"visibility",o)})),this.currentPopup&&this.currentPopup.remove(),this.addMapInteractions(this.map,e)},showJacobsonLayer(){const e="jacobson";this.layers.forEach((t=>{t.visible=t.id===e;const o=t.visible?"visible":"none";this.map.setLayoutProperty(`${t.id}-layer`,"visibility",o),this.map.setLayoutProperty(`${t.id}-outline`,"visibility",o)})),this.currentPopup&&this.currentPopup.remove(),this.addMapInteractions(this.map,e)},showCountiesLayer(){const e="states";this.layers.forEach((t=>{t.visible=t.id===e;const o=t.visible?"visible":"none";this.map.setLayoutProperty(`${t.id}-layer`,"visibility",o),this.map.setLayoutProperty(`${t.id}-outline`,"visibility",o)})),this.currentPopup&&this.currentPopup.remove(),this.addMapInteractions(this.map,e)}}};const $=(0,f.Z)(x,[["render",D]]);var N=$;const O={class:"map-overlay d-flex justify-content-center align-items-center"},T={class:"container-fluid px-0"},E={class:"row h-100"},H={class:""},I={class:"p-4 bg-white rounded w-100"},j={class:"mb-4"},W={class:"fs-4"};function U(e,t,o,n,s,l){return(0,i.wg)(),(0,i.iD)("div",O,[(0,i._)("div",T,[(0,i._)("div",E,[(0,i._)("div",H,[(0,i._)("div",I,[(0,i._)("h1",j,(0,a.zw)(o.title),1),(0,i._)("p",W,(0,a.zw)(o.content),1)])])])])])}var J={name:"MapOverlay",props:{title:{type:String,default:""},content:{type:String,default:""}}};const z=(0,f.Z)(J,[["render",U]]);var A=z;const F=e=>((0,i.dD)("data-v-59ab1767"),e=e(),(0,i.Cn)(),e),Y={id:"housingDataModal",class:"modal fade",ref:"modal",tabindex:"-1",role:"dialog","aria-hidden":"true"},Z={class:"modal-dialog modal-wide",role:"document"},G={class:"modal-content"},B={class:"modal-header"},R={class:"modal-title"},K=F((()=>(0,i._)("span",{"aria-hidden":"true"},"×",-1))),Q=[K],q={class:"modal-body sticky-padding-fix"},V=F((()=>(0,i._)("h1",null,"test title",-1))),X={class:"table table-responsive table-sticky-header"};function ee(e,t,o,n,s,l){return(0,i.wg)(),(0,i.iD)("div",Y,[(0,i._)("div",Z,[(0,i._)("div",G,[(0,i._)("div",B,[(0,i._)("h1",R,(0,a.zw)(s.modalTitle),1),(0,i._)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=(...e)=>l.hideModal&&l.hideModal(...e))},Q)]),(0,i._)("div",q,[V,(0,i._)("table",X,[(0,i._)("thead",null,[(0,i._)("tr",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.fields,(e=>((0,i.wg)(),(0,i.iD)("th",{key:e.key},(0,a.zw)(e.label),1)))),128))])]),(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.localItems,((e,t)=>((0,i.wg)(),(0,i.iD)("tr",{key:t},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.fields,(t=>((0,i.wg)(),(0,i.iD)("td",{key:t.key},(0,a.zw)(e[t.key]),1)))),128))])))),128))])])])])])],512)}var te={name:"HousingDataModal",props:{fields:Array},data(){return{modalTitle:"",localItems:[]}},methods:{showModal(){this.$emit("disable-scrolling"),this.$nextTick((()=>{const e=window.jQuery("#housingDataModal");e.modal("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open")}))},hideModal(){const e=window.jQuery(this.$refs.modal);document.body.style.overflow="",document.body.classList.remove("modal-open"),this.$emit("enable-scrolling"),e.modal("hide")},updateItems(e){console.log("updating modal items:",e),this.localItems=e}}};const oe=(0,f.Z)(te,[["render",ee],["__scopeId","data-v-59ab1767"]]);var ne=oe,ie={name:"App",components:{FullPageWrapper:b,FullPageSection:C,MapboxMap:N,HousingDataModal:ne,MapOverlay:A},data(){return{modalTitle:"",modalFields:[],modalItems:[],isMapClickable:!1}},methods:{async handleHousingDataModal({municipalityName:e,munCode:t}){this.$refs.housingDataModal.modalTitle=e;const o="/affordable-housing-viz-2/",n=await k.gyn(`${o}/data-csvs/Municipal-level-housing-data.csv`),i=n.filter((e=>e.comuMerged===t));this.modalFields=[{key:"development / aka",label:"Development"},{key:"units",label:"Units"},{key:"type",label:"Type"},{key:"agent",label:"Agent"},{key:"agent address",label:"Agent Address"},{key:"website",label:"Website"},{key:"source",label:"Source"},{key:"zip",label:"ZIP"},{key:"combinedPhone",label:"Phone"}],this.$refs.housingDataModal.updateItems(i),this.$refs.housingDataModal.showModal()},onSectionLeave(e,t){const o=document.querySelector(".map-container");3===t.index||4===t.index?(o.classList.add("show-map"),document.body.classList.add("disable-pointer-events")):(o.classList.remove("show-map"),document.body.classList.remove("disable-pointer-events"))}}};const ae=(0,f.Z)(ie,[["render",u]]);var se=ae;o(6744);(0,n.ri)(se).mount("#app")}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,n,i,a){if(!n){var s=1/0;for(d=0;d<e.length;d++){n=e[d][0],i=e[d][1],a=e[d][2];for(var l=!0,r=0;r<n.length;r++)(!1&a||s>=a)&&Object.keys(o.O).every((function(e){return o.O[e](n[r])}))?n.splice(r--,1):(l=!1,a<s&&(s=a));if(l){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,i,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,a,s=n[0],l=n[1],r=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(i in l)o.o(l,i)&&(o.m[i]=l[i]);if(r)var d=r(o)}for(t&&t(n);c<s.length;c++)a=s[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},n=self["webpackChunkhousing_viz_prj"]=self["webpackChunkhousing_viz_prj"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(7812)}));n=o.O(n)})();
//# sourceMappingURL=app.e1e1f3b4.js.map